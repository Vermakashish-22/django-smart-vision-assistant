{% extends 'base.html' %}
{% load static %}
{% block title %} Add Patient {% endblock %}
{% block bodyclass %} hold-transition sidebar-mini {% endblock %}

{% block content %}
<section class="content pt-4">
    <div class="container-fluid d-flex justify-content-center">
        <div class="card" style="width: 40rem;">
        <div class="card-header text-center" style="background-color: #134e4a; color: white;">
            <h4 class="mb-0">Add Patient</h4>
        </div>
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}

                {% if messages %}
                    {% for message in messages %}
                        <div id="toast-popup"
                            class="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 rounded shadow-lg flex items-center gap-3 transition-all duration-300
                            {% if message.tags == 'success' %}
                            bg-green-600 text-white
                            {% elif message.tags == 'error' %}
                            bg-red-600 text-white
                            {% elif message.tags == 'warning' %}
                            bg-yellow-500 text-black
                            {% elif message.tags == 'info' %}
                            bg-blue-600 text-white
                            {% else %}
                            bg-gray-700 text-white
                            {% endif %}
                            ">

                        <!-- ICONS -->
                        {% if message.tags == 'success' %}
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                        {% elif message.tags == 'error' %}
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        {% elif message.tags == 'warning' %}
                            <svg class="w-5 h-5 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01M12 4a8 8 0 100 16 8 8 0 000-16z"/>
                            </svg>
                        {% elif message.tags == 'info' %}
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z"/>
                            </svg>
                        {% endif %}

                        <!-- MESSAGE TEXT -->
                        <span>{{ message }}</span>

                        <!-- DISMISS BUTTON -->
                        <button onclick="closeToast()" class="ml-auto font-bold hover:opacity-80">
                            &times;
                        </button>
                    </div>
                    {% endfor%}
                {% endif %}

            <div class="card-body">

            
            <div class="form-group">
                <label for="name">Patient Name</label>
                <input type="text" name="name" class="form-control" autocomplete="off" placeholder="Enter patient name" required>
            </div>

            <div class="form-group">
                <label for="image">Profile Image</label>
                <input type="file" name="image" class="form-control">
            </div>

            <div class="form-group">
                <label for="assigned_doctor">Select Doctor</label>
                <select name="assigned_doctor" class="form-control" required>
                <option value="" disabled selected>Select doctor</option>
                {% for doctor in doctors %}
                    <option value="{{ doctor.id }}">{{ doctor.user.first_name }}</option>
                {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="appointment_date">Date</label>
                <input type="date" name="appointment_date" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="appointment_time">Time</label>
                <input type="time" name="appointment_time" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="disease">Disease</label>
                <textarea name="disease" rows="3" class="form-control" placeholder="Describe the illness..." required></textarea>
            </div>

            </div>

            <div class="card-footer text-center">
            <button type="submit" class="btn text-white" style="background-color: #134e4a;">Save Patient</button>
            </div>
        </form>
        </div>
    </div>
</section>

<script>
    function closeToast() {
        document.getElementById('toast-popup').style.display = 'none';
    }

    // Auto-close after 3 seconds
    setTimeout(closeToast, 3000);
</script>

{% endblock %}
